<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Churn Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap Datepicker -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <header class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-line me-2 animate-icon"></i>Churn Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#insights">Insights</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#contact">Contact</a>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block sidebar">
                <div class="position-sticky pt-4">
                    <h5 class="sidebar-heading">Navigation</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#upload-section"><i class="fas fa-upload me-2 animate-icon"></i>Upload Data</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#chatbot-section"><i class="fas fa-robot me-2 animate-icon"></i>Churn Assistant</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#download-report-section"><i class="fas fa-download me-2 animate-icon"></i>Download Report</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#insights"><i class="fas fa-chart-pie me-2 animate-icon"></i>Insights</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Content Area -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
                <!-- Hero Section -->
                <div class="hero-section text-center py-5">
                    <h1 class="display-4 fw-bold">Customer Churn Dashboard</h1>
                    <p class="lead">Analyze churn trends to retain customers.</p>
                    <a href="#upload-section" class="btn btn-primary btn-lg mt-3 glow-btn"><i class="fas fa-rocket me-2 animate-icon"></i>Get Started</a>
                </div>

                <!-- Upload Section -->
                <section id="upload-section" class="mb-5">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#upload-collapse" aria-expanded="true">
                            <h5><i class="fas fa-upload me-2 animate-icon"></i>Upload Customer Data</h5>
                        </div>
                        <div id="upload-collapse" class="collapse show">
                            <div class="card-body">
                                <form id="uploadForm" enctype="multipart/form-data">
                                    <div class="mb-3">
                                        <label for="csvFile" class="form-label">Upload a CSV file</label>
                                        <input class="form-control" type="file" id="csvFile" accept=".csv" data-tooltip="CSV must include a 'Churn' column">
                                        <div class="form-text">Include a 'Churn' column for analysis.</div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="currentRevenue" class="form-label">Current Monthly Revenue (₹)</label>
                                        <input class="form-control" type="number" id="currentRevenue" placeholder="Enter current revenue" data-tooltip="Used for revenue predictions" style="cursor: text;">
                                        <div class="form-text">Used to predict future revenue trends.</div>
                                    </div>
                                    <button type="submit" class="btn btn-primary glow-btn">
                                        <i class="fas fa-upload me-2 animate-icon"></i>Analyze
                                    </button>
                                </form>
                                <div id="upload-status" class="mt-3"></div>
                                <div id="revenue-prediction" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Date Filter Section -->
                <section id="date-filter-section" class="mb-5" style="display: none;">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#date-filter-collapse">
                            <h5><i class="fas fa-calendar-alt me-2 animate-icon"></i>Date Range Analysis</h5>
                        </div>
                        <div id="date-filter-collapse" class="collapse show">
                            <div class="card-body">
                                <form id="dateFilterForm">
                                    <div class="row g-3">
                                        <div class="col-md-5">
                                            <label for="filter-month" class="form-label">Month</label>
                                            <input type="text" class="form-control datepicker-month" id="filter-month" placeholder="Select month" data-tooltip="Filter by signup month" style="cursor: pointer;">
                                        </div>
                                        <div class="col-md-5">
                                            <label for="filter-year" class="form-label">Year</label>
                                            <input type="text" class="form-control datepicker-year" id="filter-year" placeholder="Select year" data-tooltip="Filter by signup year" style="cursor: pointer;">
                                        </div>
                                        <div class="col-md-2 d-flex align-items-end">
                                            <button type="submit" class="btn btn-primary w-100 glow-btn">
                                                <i class="fas fa-filter me-2 animate-icon"></i>Apply
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Data Summary Section -->
                <section id="data-summary-section" class="mb-5" style="display: none;">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#summary-collapse">
                            <h5><i class="fas fa-database me-2 animate-icon"></i>Dataset Summary</h5>
                        </div>
                        <div id="summary-collapse" class="collapse show">
                            <div class="card-body">
                                <div class="row g-4">
                                    <div class="col-md-3">
                                        <div class="metrics-card">
                                            <div class="value" id="total-customers">0</div>
                                            <div class="label">Customers</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metrics-card">
                                            <div class="value" id="total-columns">0</div>
                                            <div class="label">Attributes</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metrics-card">
                                            <div class="value" id="total-missing">0</div>
                                            <div class="label">Missing Values</div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="metrics-card">
                                            <div class="value" id="data-quality">0%</div>
                                            <div class="label">Data Quality</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Customer Segmentation Section -->
                <section id="segmentation-section" class="mb-5" style="display: none;">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#segmentation-collapse">
                            <h5><i class="fas fa-users me-2 animate-icon"></i>Customer Segmentation</h5>
                        </div>
                        <div id="segmentation-collapse" class="collapse show">
                            <div class="card-body">
                                <div id="segmentation-content"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Retention Strategy Simulator -->
                <section id="retention-simulator-section" class="mb-5" style="display: none;">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#retention-collapse">
                            <h5><i class="fas fa-shield-alt me-2 animate-icon"></i>Retention Strategy Simulator</h5>
                        </div>
                        <div id="retention-collapse" class="collapse show">
                            <div class="card-body">
                                <form id="retentionSimulatorForm">
                                    <div class="mb-3">
                                        <label for="churn-reduction" class="form-label">Target Churn Reduction (%)</label>
                                        <input type="number" class="form-control" id="churn-reduction" placeholder="Enter percentage (0-100)" data-tooltip="Simulate churn reduction impact" style="cursor: text;">
                                    </div>
                                    <button type="submit" class="btn btn-primary glow-btn">
                                        <i class="fas fa-calculator me-2 animate-icon"></i>Simulate
                                    </button>
                                </form>
                                <div id="retention-result" class="mt-3"></div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Chatbot Section -->
                <section id="chatbot-section" class="mb-5">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#chatbot-collapse">
                            <h5><i class="fas fa-robot me-2 animate-icon"></i>Churn Assistant</h5>
                        </div>
                        <div id="chatbot-collapse" class="collapse show">
                            <div class="card-body">
                                <div id="chatbot-messages" class="mb-4"></div>
                                <div id="quick-questions" class="mb-4">
                                    <span class="fw-bold mb-3 d-block">Quick Questions:</span>
                                    <div class="d-flex flex-wrap gap-2">
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="What is the current churn rate?">Churn Rate</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="How does churn affect revenue?">Revenue Impact</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="What are the top reasons for churn?">Top Churn Reasons</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="What can we do to reduce churn?">Recommendations</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="How accurate is the churn prediction model?">Model Accuracy</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="What is the churn trend?">Churn Trend</button>
                                        <button class="btn btn-outline-primary quick-question glow-btn" data-question="Which customer segment has the highest churn?">Segment Analysis</button>
                                    </div>
                                </div>
                                <div id="chatbot-input">
                                    <div class="input-group">
                                        <input type="text" id="chat-input" class="form-control" placeholder="Ask about churn..." data-tooltip="Ask about churn trends or recommendations" style="cursor: text;">
                                        <button id="chat-submit" class="btn btn-primary glow-btn">
                                            <i class="fas fa-paper-plane animate-icon"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Download Report Section -->
                <section id="download-report-section" class="mb-5" style="display: none;">
                    <div class="card">
                        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#download-collapse">
                            <h5><i class="fas fa-download me-2 animate-icon"></i>Download Report</h5>
                        </div>
                        <div id="download-collapse" class="collapse show">
                            <div class="card-body">
                                <p class="mb-3">Download a detailed PDF report of your churn analysis.</p>
                                <a href="/download_report" id="download-report-btn" class="btn btn-primary glow-btn">
                                    <i class="fas fa-file-pdf me-2 animate-icon"></i>Download PDF Report
                                </a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Insights Section -->
                <section id="insights" class="mb-5" style="display: none;">
                    <h2 class="section-title mb-4">Churn Insights</h2>
                    <div id="insights-warnings" class="mt-3"></div>
                    <div id="dashboard-content">
                        <div class="row g-4">
                            <!-- Key Metrics -->
                            <div class="col-md-4">
                                <div class="card h-100">
                                    <div class="card-header">
                                        <i class="fas fa-percentage me-2 animate-icon"></i>Key Metrics
                                    </div>
                                    <div class="card-body">
                                        <div class="metrics-card mb-4">
                                            <div class="value text-danger" id="churn-rate">0%</div>
                                            <div class="label">Churn Rate</div>
                                        </div>
                                        <div class="metrics-card mb-4">
                                            <div class="value text-success" id="model-accuracy">0%</div>
                                            <div class="label">Model Accuracy</div>
                                        </div>
                                        <div class="metrics-card mb-4">
                                            <div class="value text-warning" id="monthly-loss">₹0</div>
                                            <div class="label">Monthly Revenue at Risk</div>
                                        </div>
                                        <div class="metrics-card">
                                            <div class="value text-danger" id="yearly-loss">₹0</div>
                                            <div class="label">Annual Revenue at Risk</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Churn Distribution -->
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-pie me-2 animate-icon"></i>Churn Distribution
                                    </div>
                                    <div class="card-body">
                                        <div id="churn-distribution" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row g-4 mt-4">
                            <!-- Tenure vs Churn -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-clock me-2 animate-icon"></i>Tenure vs Churn
                                    </div>
                                    <div class="card-body">
                                        <div id="tenure-chart" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Monthly Charges vs Churn -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-rupee-sign me-2 animate-icon"></i>Monthly Charges vs Churn
                                    </div>
                                    <div class="card-body">
                                        <div id="charges-chart" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row g-4 mt-4">
                            <!-- Contract Type vs Churn -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-file-contract me-2 animate-icon"></i>Contract Type vs Churn
                                    </div>
                                    <div class="card-body">
                                        <div id="contract-chart" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- Feature Importance -->
                            <div class="col-md-6">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-bar me-2 animate-icon"></i>Feature Importance
                                    </div>
                                    <div class="card-body">
                                        <div id="feature-importance-chart" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row g-4 mt-4">
                            <!-- Churn Rate Over Time -->
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-header">
                                        <i class="fas fa-chart-line me-2 animate-icon"></i>Churn Rate Over Time
                                    </div>
                                    <div class="card-body">
                                        <div id="churn-over-time" class="chart-container"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Chatbot Toggle -->
    <div id="chatbot-toggle" class="glow-btn">
        <i class="fas fa-robot animate-icon"></i>
    </div>

    <!-- Back to Top Button -->
    <a href="#" id="back-to-top" class="glow-btn">
        <i class="fas fa-arrow-up animate-icon"></i>
    </a>

    <!-- Contact Section -->
    <section class="contact-section" id="contact">
        <div class="container">
            <h2 class="section-title mb-4">Contact Us</h2>
            <p class="text-center">Reach out at <a href="mailto:mohammedparvezofficial@gmail.com">mohammedparvezofficial@gmail.com</a>.</p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p>© 2025 Customer Churn Dashboard. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker@1.9.0/dist/js/bootstrap-datepicker.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="static/js/script.js"></script>
</body>
</html>